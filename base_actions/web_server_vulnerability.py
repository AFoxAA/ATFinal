import logging
import yaml
from typing import Any
import subprocess


class WebServerEvaluation:
    def __init__(self) -> None:
        self.config_data = self.loading_config()

    def loading_config(self) -> dict:
        with open('config.yaml') as file:
            return yaml.safe_load(file)

    def executing_nikto_command(self, command: Any) -> str:
        logging.info('Выполнение команды Nikto и перехват ответа')
        command_output = subprocess.run(command, shell=True, stdout=subprocess.PIPE, encoding='utf-8')

        if command_output.returncode == 0 and command_output.stdout:
            return command_output.stdout
        else:
            return ""

    def get_nikto_command(self, test_site: str):
        logging.info('Получаем команду инструмента Nikto')
        return f'nikto -h {test_site} {self.config_data["option_1"]} {self.config_data["option_2"]}'
