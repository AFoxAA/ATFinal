import logging
import pytest
from base_actions import WebServerEvaluation


def test_positive_website_vulnerability(site_vulnerabilities: str, expected_result: str, expected_site: str) -> None:
    logging.info(site_vulnerabilities)
    web_server_evaluator = WebServerEvaluation()
    file_config_data = web_server_evaluator.loading_config()
    test_site = file_config_data.get('test_site')

    if not test_site or not isinstance(test_site, str) or expected_site != test_site:
        logging.exception("Ошибка: Некорректное значение test_site")

    received_command = web_server_evaluator.get_nikto_command(test_site)
    received_text = web_server_evaluator.executing_nikto_command(received_command)

    assert expected_result in received_text, logging.exception(f'Ошибка: Текст {expected_result} не найден в выводе')


if __name__ == '__main__':
    pytest.main(['-vv'])
